{% extends "base.html" %}

{% block title %}Lista de Instructores SENA - SENA APP{% endblock %}

{% block content %}
<!-- Header Section -->
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4">
            <div class="mb-3 mb-md-0">
                <h1 class="display-5 fw-bold mb-2" style="color: #008000;">
                    üë®‚Äçüè´ Lista de Instructores
                </h1>
                <div>
                    <span class="badge bg-info fs-6">Total: {{ total_instructores }} instructores</span>
                    <a href="{% url 'instructores:crear_instructor' %}" class="btn btn-success ms-2">
                        <i class="fas fa-plus me-2"></i>Nuevo Instructor
                    </a>
                </div>
                <p class="lead text-muted mb-0">
                    Informaci√≥n completa de todos los instructores registrados
                </p>
            </div>
            <div>
                <a href="{% url 'aprendices:inicio' %}" class="back-link">
                    ‚Üê Regresar al Inicio
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Summary -->
<div class="row mb-4">
    <div class="col-md-4">
        <div class="info-item text-center">
            <div class="d-flex align-items-center justify-content-center mb-2">
                <span style="font-size: 1.5rem; margin-right: 10px;">üìä</span>
                <div>
                    <h4 class="mb-0 fw-bold" style="color: #008000;">{{ total_instructores }}</h4>
                    <small class="text-muted">Total de Instructores</small>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="info-item text-center">
            <div class="d-flex align-items-center justify-content-center mb-2">
                <span style="font-size: 1.5rem; margin-right: 10px;">‚úÖ</span>
                <div>
                    <h4 class="mb-0 fw-bold" style="color: #ff6600;">Activos</h4>
                    <small class="text-muted">En Servicio</small>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="info-item text-center">
            <div class="d-flex align-items-center justify-content-center mb-2">
                <span style="font-size: 1.5rem; margin-right: 10px;">üéì</span>
                <div>
                    <h4 class="mb-0 fw-bold" style="color: #008000;">2025</h4>
                    <small class="text-muted">A√±o Actual</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Table Card -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center">
                    <span style="font-size: 1.5rem; margin-right: 15px;">üìã</span>
                    <div>
                        <h5 class="mb-1">Registro de Instructores</h5>
                        <small class="opacity-75">Lista detallada con informaci√≥n de contacto y especialidades</small>
                    </div>
                </div>
                <div class="badge badge-sena fs-6 px-3 py-2">
                    {{ total_instructores }} registros
                </div>
            </div>
            <div class="card-body p-0">
                {% if lista_instructores %}
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>
                                        <i class="fas fa-id-card"></i> Documento
                                    </th>
                                    <th>
                                        <i class="fas fa-file-alt"></i> Tipo
                                    </th>
                                    <th>
                                        <i class="fas fa-user"></i> Nombre Completo
                                    </th>
                                    <th>
                                        <i class="fas fa-envelope"></i> Correo
                                    </th>
                                    <th>
                                        <i class="fas fa-phone"></i> Tel√©fono
                                    </th>
                                    <th>
                                        <i class="fas fa-map-marker-alt"></i> Ciudad
                                    </th>
                                    <th>
                                        <i class="fas fa-home"></i> Direcci√≥n
                                    </th>
                                    <th>
                                        <i class="fas fa-graduation-cap"></i> Nivel Educativo
                                    </th>
                                    <th>
                                        <i class="fas fa-birthday-cake"></i> F. Nacimiento
                                    </th>
                                    <th>
                                        <i class="fas fa-award"></i> Especialidad
                                    </th>
                                    <th class="text-center" style="width: 120px;">
                                        <i class="fas fa-cogs"></i> Acciones
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for instructor in lista_instructores %}
                                <tr>
                                    <td class="fw-semibold" style="color: #2d3436;">
                                        <strong>
                                            <a href="{% url 'instructores:detalle_instructor' instructor.id %}" class="text-decoration-none" style="color: #008000;">
                                                {{ instructor.documento_identidad }}
                                            </a>
                                        </strong>
                                    </td>
                                    <td>
                                        <span class="badge bg-secondary px-2 py-1">
                                            {{ instructor.tipo_documento }}
                                        </span>
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="instructor-avatar me-3" style="width: 40px; height: 40px; font-size: 1rem;">
                                                {{ instructor.nombre|first }}{{ instructor.apellido|first }}
                                            </div>
                                            <div>
                                                <div class="fw-bold" style="color: #2d3436;">
                                                    {{ instructor.nombre_completo }}
                                                </div>
                                                <small class="text-muted">
                                                    {% if instructor.activo %}
                                                        <span class="text-success">‚óè Activo</span>
                                                    {% else %}
                                                        <span class="text-danger">‚óè Inactivo</span>
                                                    {% endif %}
                                                </small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        {% if instructor.correo %}
                                            <div class="d-flex align-items-center">
                                                <span style="color: #008000; margin-right: 8px;">@</span>
                                                <a href="mailto:{{ instructor.correo }}" class="text-decoration-none text-muted" title="{{ instructor.correo }}">
                                                    {{ instructor.correo|truncatechars:25 }}
                                                </a>
                                            </div>
                                        {% else %}
                                            <span class="text-muted fst-italic">No registrado</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if instructor.telefono %}
                                            <div class="d-flex align-items-center">
                                                <span style="color: #ff6600; margin-right: 8px;">üìû</span>
                                                <a href="tel:{{ instructor.telefono }}" class="text-decoration-none text-muted">
                                                    {{ instructor.telefono }}
                                                </a>
                                            </div>
                                        {% else %}
                                            <span class="text-muted fst-italic">No registrado</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if instructor.ciudad %}
                                            <div class="d-flex align-items-center">
                                                <span style="color: #008000; margin-right: 8px;">üìç</span>
                                                <span class="text-muted">{{ instructor.ciudad }}</span>
                                            </div>
                                        {% else %}
                                            <span class="text-muted fst-italic">No registrada</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if instructor.direccion %}
                                            <span class="text-muted" title="{{ instructor.direccion }}">
                                                {{ instructor.direccion|truncatechars:20 }}
                                            </span>
                                        {% else %}
                                            <span class="text-muted fst-italic">No registrada</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if instructor.nivel_educativo %}
                                            <span class="badge badge-sena px-2 py-1" title="{{ instructor.get_nivel_educativo_display }}">
                                                {{ instructor.nivel_educativo|truncatechars:15 }}
                                            </span>
                                        {% else %}
                                            <span class="text-muted fst-italic">No especificado</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if instructor.fecha_nacimiento %}
                                            <small class="text-muted">
                                                {{ instructor.fecha_nacimiento|date:"d/m/Y" }}
                                            </small>
                                        {% else %}
                                            <span class="text-muted fst-italic">No registrada</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if instructor.especialidad %}
                                            <span class="badge bg-success px-2 py-1" title="{{ instructor.especialidad }}">
                                                {{ instructor.especialidad|truncatechars:20 }}
                                            </span>
                                        {% else %}
                                            <span class="text-muted fst-italic">No especificada</span>
                                        {% endif %}
                                    </td>
                                    <td class="text-center">
                                        <div class="btn-group" role="group">
                                            <a href="{% url 'instructores:detalle_instructor' instructor.id %}" 
                                               class="btn btn-info btn-sm px-3" 
                                               title="Ver detalles completos">
                                                <i class="fas fa-eye"></i>
                                            </a>
                                            <a href="{% url 'admin:instructores_instructor_change' instructor.pk %}" 
                                               class="btn btn-outline-primary btn-sm"
                                               title="Editar instructor">
                                                <i class="fas fa-edit"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <div class="text-center py-5">
                        <div style="font-size: 6rem; margin-bottom: 20px;">üë®‚Äçüè´</div>
                        <h4 class="fw-bold mb-3" style="color: #ff6600;">No hay instructores registrados</h4>
                        <p class="text-muted mb-4">
                            A√∫n no se han registrado instructores en el sistema.
                        </p>
                        <a href="{% url 'instructores:crear_instructor' %}" class="btn btn-success">
                            <i class="fas fa-plus me-2"></i>Registrar Primer Instructor
                        </a>
                    </div>
                {% endif %}
            </div>
            {% if lista_instructores %}
            <div class="card-footer bg-light">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <small class="text-muted">
                            <i class="fas fa-info-circle me-1"></i>
                            Mostrando {{ lista_instructores|length }} de {{ total_instructores }} instructores registrados
                        </small>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <small class="text-muted">
                            <i class="fas fa-calendar me-1"></i>
                            √öltima actualizaci√≥n: {% now "d/m/Y H:i" %}
                        </small>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Action Buttons -->
{% if lista_instructores %}
<div class="row mt-4">
    <div class="col-12 text-center">
        <div class="d-flex flex-wrap justify-content-center gap-3">
            <a href="{% url 'instructores:crear_instructor' %}" class="btn btn-primary btn-lg px-4">
                <i class="fas fa-plus me-2"></i>Agregar Nuevo Instructor
            </a>
            <button class="btn btn-success btn-lg px-4" onclick="window.print()">
                <i class="fas fa-print me-2"></i>Imprimir Lista
            </button>
            <a href="{% url 'aprendices:inicio' %}" class="btn btn-secondary btn-lg px-4">
                <i class="fas fa-home me-2"></i>Volver al Inicio
            </a>
        </div>
    </div>
</div>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    // A√±adir efecto de carga a la tabla
    const table = document.querySelector('table');
    if (table) {
        table.style.opacity = '0';
        table.style.transform = 'translateY(20px)';
        table.style.transition = 'all 0.6s ease';
        
        setTimeout(() => {
            table.style.opacity = '1';
            table.style.transform = 'translateY(0)';
        }, 100);
    }
    
    // Mejorar la experiencia de hover en las filas
    const rows = document.querySelectorAll('tbody tr');
    rows.forEach(row => {
        row.addEventListener('mouseenter', function() {
            this.style.backgroundColor = 'rgba(0, 184, 148, 0.08)';
            this.style.borderLeft = '4px solid #00b894';
            this.style.paddingLeft = '8px';
        });
        
        row.addEventListener('mouseleave', function() {
            this.style.backgroundColor = '';
            this.style.borderLeft = '';
            this.style.paddingLeft = '';
        });
    });
    
    // Agregar campo de b√∫squeda din√°micamente
    const cardHeader = document.querySelector('.card-header');
    if (cardHeader && document.querySelector('table')) {
        const searchContainer = document.createElement('div');
        searchContainer.className = 'mt-3';
        searchContainer.innerHTML = `
            <div class="input-group">
                <span class="input-group-text" style="background: linear-gradient(135deg, #008000 0%, #ff6600 100%); color: white; border: none;">
                    <i class="fas fa-search"></i>
                </span>
                <input type="text" class="form-control" id="busquedaInstructores" 
                       placeholder="Buscar por nombre, documento, correo, especialidad..." 
                       onkeyup="filtrarInstructores()"
                       style="border-left: none;">
            </div>
        `;
        cardHeader.appendChild(searchContainer);
    }
});

// Funcionalidad de b√∫squeda en tiempo real
function filtrarInstructores() {
    const input = document.getElementById('busquedaInstructores');
    const filter = input.value.toLowerCase();
    const table = document.querySelector('table tbody');
    const rows = table.getElementsByTagName('tr');

    for (let i = 0; i < rows.length; i++) {
        const cells = rows[i].getElementsByTagName('td');
        let found = false;
        
        for (let j = 0; j < cells.length; j++) {
            if (cells[j]) {
                const textValue = cells[j].textContent || cells[j].innerText;
                if (textValue.toLowerCase().indexOf(filter) > -1) {
                    found = true;
                    break;
                }
            }
        }
        
        rows[i].style.display = found ? '' : 'none';
    }
}
</script>
{% endblock %}